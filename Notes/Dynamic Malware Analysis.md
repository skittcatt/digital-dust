### Quick Notes

- Serves as a quick way to see the processes and behaviour of malware (in a contained environment like a virtual machine).
- Should be done with a static analysis, usually before.
- The VM that the analysis will be done inside should appear as 'normal' as possible - to attract attackers (not a honeypot) or let the malware 'think' its inside a usual victim device.

---
### Setting up Virtualization Software

- (Personally) Use VMware.
- Set up snapshots to make it easier to go back after malware analysis.
	- Create snapshots AFTER installing required software for analysis (see next point).
- Installed software should be as follows:
	- Analysis Software:
		- Procmon
		- Process Hacker
		- Wireshark
		- Fiddler
		- RegShot
		- Sysmon
		- BinText
		- HashMyFile
	- 'Normal' Software & Utility:
		- Standard browsers (Chrome, Firefox, etc)
		- Microsoft Office
		- Adobe Reader
		- WinRAR (or any other RAR software)
		- Notepad++
- Allocate at least 4gb of RAM per VM.
- Disable ALL Firewall/Windows Defender/Anti-Malware solutions as we are aiming to see the full capabilities of the malware.
- Rename the VMOS.
- Disable auto-updates.
- Disable hidden extensions (Windows 10):
	1. File explorer
	2. 'Change folder and search options'
	3. Uncheck 'hide extensions for known file types'
- Show hidden files and folders.
- Disable ASLR (not required at start but may be important later):
	1. Go to Registry Editor (regedit)
	2. 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management'
	3. Create a "REG_DWORD" type key named "MoveImages"
- Change network settings (prevents malware from spreading through the network):
	1. "VM" menu in VMware
	2. Settings
	3. Hardware
	4. Network Adapter
	5. Chose "Custom"

---
### What to pay attention to?

**Processes**
- Use Process Hacker and Procmon.
	- Tasklist inside CMD
	- service.msc for GUI
- Should run these and examine normal activity before launching the malware.

**Network**
- Wireshark and Fiddler (for HTTP).
- Malware typically only communicates through HTTP and SMTP.

**Registry**
- RegShot to take a snapshot before and after launching the malware.
	- Can compare once the after shot is taken.
- regedit for GUI, shows info of programs on the system.
	- HKEY_CURRENT_USER / HKCU
	- HKEY_LOCAL_MACHINE / HKLM
	- HKEY_USERS / HKU
	- HEY_CLASSES_ROOT / HKCR
	- HKCC would not be targeted as often.

**Files Activities**
- Malware likes to hide files inside the temporary files folder (persistence).
- Access via:
	- Win + R (run)
	- Open: %temp%
- Malware can also copy itself into other directories such as startup/commonstartup.
- Access via:
	- (run) shell:common startup
	- (run) shell:startup

---
### Malware Doesn't Work?

- Give it time, some malware is set to not activate for a given amount of time.
- Execute as admin.
- Geolocation-locked malware - change network (VPN).
